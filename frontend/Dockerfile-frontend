# ====================================================================
# Frontend Webapp -- build and serve to an exposed port with Vite
# ====================================================================
# External Nginx will direct traffic here.
FROM node:22-alpine

# Copy files into the container
WORKDIR /app
COPY . .

# Check the .env file
RUN echo "The value of APP_ENVIRONMENT is: ${APP_ENVIRONMENT}"

# Install packages and build the app
RUN npm install --legacy-peer-deps
RUN npm run build

# Using "preview" instead of "dev" when inside docker
EXPOSE 5173
CMD ["npm", "run", "preview", "--", "--host", "0.0.0.0"]
